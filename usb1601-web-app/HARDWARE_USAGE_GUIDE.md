# USB-1601 硬件使用指南

## ✅ 系统已就绪

后端服务已成功启动，支持**硬件模式**和**模拟模式**自动切换。

## 🚀 快速测试

### 1. **硬件检测测试**
打开浏览器访问硬件测试页面：
```
file:///D:/Documents/seesharptools-web/usb1601-web-app/hardware_test.html
```

按以下步骤测试：
1. 点击 **"🔍 检测硬件"** - 检查USB-1601设备是否连接
2. 点击 **"🔧 初始化硬件模式"** - 尝试使用真实硬件
3. 如果硬件不可用，点击 **"💻 初始化模拟模式"** - 使用软件模拟
4. 点击 **"▶️ 开始采集"** - 开始数据采集
5. 点击 **"⏹️ 停止采集"** - 停止数据采集

### 2. **主应用访问**
```
http://localhost:3000
```

## 📋 API端点说明

### 新增的HybridData API（推荐使用）

| 端点 | 方法 | 说明 |
|------|------|------|
| `/api/hybriddata/detect-hardware` | GET | 检测USB-1601硬件 |
| `/api/hybriddata/initialize` | POST | 初始化系统（自动选择模式） |
| `/api/hybriddata/start` | POST | 开始数据采集 |
| `/api/hybriddata/stop` | POST | 停止数据采集 |
| `/api/hybriddata/switch-mode` | POST | 切换硬件/模拟模式 |
| `/api/hybriddata/status` | GET | 获取系统状态 |

### 其他可用API

- `/api/simpledata/*` - 简化API（仅模拟模式）
- `/api/dataacquisition/*` - 原始API（需要硬件）

## 🔧 硬件连接检查

### 如果硬件检测失败，请检查：

1. **USB连接**
   - 确保USB-1601设备已连接到计算机
   - 检查设备管理器中是否识别设备

2. **驱动文件**
   - 确认 `JYUSB1601.dll` 文件存在于 `drivers` 目录
   - 路径：`D:\Documents\seesharptools-web\usb1601-web-app\drivers\JYUSB1601.dll`

3. **设备索引**
   - 默认使用设备索引0
   - 如果有多个设备，可能需要调整索引

## 💡 模式说明

### **硬件模式**
- ✅ 真实数据采集
- ✅ 高精度测量
- ✅ 支持多通道
- ❌ 需要USB-1601设备

### **模拟模式**
- ✅ 无需硬件
- ✅ 多种信号类型（正弦波、方波、三角波、锯齿波）
- ✅ 可配置参数
- ✅ 适合开发测试

## 🎯 智能切换特性

系统会自动处理硬件故障：
1. 首次尝试使用硬件
2. 如果硬件失败，自动切换到模拟模式
3. 用户无感知切换，保证系统可用性

## 📊 实时数据流

系统使用SignalR WebSocket推送实时数据：
- 数据推送频率：10Hz（每100ms）
- 每批数据点：100个样本
- 支持多客户端同时接收

## 🐛 故障排除

### 问题：提示"未找到JYUSB1601.dll"
**解决**：确保驱动文件在正确位置，或复制到 `backend\USB1601Service\bin\Debug\net8.0\` 目录

### 问题：硬件初始化失败
**解决**：
1. 检查设备连接
2. 重启设备
3. 使用模拟模式继续工作

### 问题：数据不显示
**解决**：
1. 检查浏览器控制台错误
2. 确认WebSocket连接正常
3. 刷新页面重试

## 📝 测试检查清单

- [ ] 硬件检测功能正常
- [ ] 模拟模式可以启动
- [ ] 数据采集可以开始/停止
- [ ] 模式切换功能正常
- [ ] WebSocket数据推送正常
- [ ] 前端波形显示正常

## 🆘 支持

如遇问题，请查看：
- 系统日志：浏览器F12控制台
- 后端日志：命令行窗口输出
- API文档：http://localhost:5000/swagger