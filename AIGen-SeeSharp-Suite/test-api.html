<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIGen-SeeSharp-Suite APIæµ‹è¯•</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .test-section h2 {
            color: #667eea;
            margin-top: 0;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        textarea {
            width: 100%;
            min-height: 150px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
        }
        select {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
        }
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            max-height: 400px;
            overflow-y: auto;
        }
        .success {
            color: green;
            font-weight: bold;
        }
        .error {
            color: red;
            font-weight: bold;
        }
        .info {
            color: #667eea;
            font-style: italic;
        }
        .code-block {
            background: #f4f4f4;
            padding: 10px;
            border-left: 3px solid #667eea;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }
        .status-success { background: #4caf50; }
        .status-error { background: #f44336; }
        .status-loading { background: #ff9800; animation: pulse 1s infinite; }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ AIGen-SeeSharp-Suite API æµ‹è¯•é¢æ¿</h1>
        
        <div class="test-section">
            <h2>1. æµ‹è¯•è¿æ¥çŠ¶æ€</h2>
            <button onclick="testConnection()">æµ‹è¯•APIè¿æ¥</button>
            <div id="connectionResult" class="result"></div>
        </div>

        <div class="test-section">
            <h2>2. ç”ŸæˆC#è§£å†³æ–¹æ¡ˆ</h2>
            
            <label for="prompt">éœ€æ±‚æè¿°ï¼ˆæ”¯æŒMISDæ ‡å‡†ï¼‰:</label>
            <textarea id="prompt" placeholder="ä¾‹å¦‚ï¼šåˆ›å»ºä¸€ä¸ªä½¿ç”¨JYUSB-1601è¿›è¡Œæ•°æ®é‡‡é›†çš„ç¨‹åºï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š
1. åˆå§‹åŒ–USB-1601è®¾å¤‡ï¼ˆè®¾å¤‡IDä¸º0ï¼‰
2. é…ç½®æ¨¡æ‹Ÿè¾“å…¥é€šé“0ï¼Œé‡ç¨‹-10Våˆ°+10V
3. é‡‡æ ·ç‡è®¾ç½®ä¸º1000Hz
4. è¿ç»­é‡‡é›†1000ä¸ªæ•°æ®ç‚¹
5. å°†æ•°æ®ä¿å­˜åˆ°CSVæ–‡ä»¶">åˆ›å»ºä¸€ä¸ªä½¿ç”¨JYUSB-1601è¿›è¡Œæ¨¡æ‹Ÿä¿¡å·é‡‡é›†çš„æ§åˆ¶å°ç¨‹åºï¼Œé…ç½®é€šé“0ï¼Œé‡‡æ ·ç‡1000Hzï¼Œé‡‡é›†1000ä¸ªæ•°æ®ç‚¹å¹¶æ˜¾ç¤ºå¹³å‡å€¼ã€‚</textarea>
            
            <label for="model">é€‰æ‹©AIæ¨¡å‹:</label>
            <select id="model">
                <option value="ernie-4.5-turbo-128k">ERNIE 4.5 Turbo (æ¨è)</option>
                <option value="ernie-x1-turbo-32k">ERNIE X1 Turbo</option>
                <option value="ernie-speed-128k">ERNIE Speed</option>
                <option value="ernie-lite-8k">ERNIE Lite (å¿«é€Ÿ)</option>
            </select>
            
            <button onclick="generateSolution()">ç”Ÿæˆè§£å†³æ–¹æ¡ˆ</button>
            <div id="generateResult" class="result"></div>
        </div>

        <div class="test-section">
            <h2>3. é¢„è®¾æµ‹è¯•ç”¨ä¾‹</h2>
            <button onclick="runPresetTest('ai')">æµ‹è¯•ï¼šæ¨¡æ‹Ÿè¾“å…¥(AI)</button>
            <button onclick="runPresetTest('ao')">æµ‹è¯•ï¼šæ¨¡æ‹Ÿè¾“å‡º(AO)</button>
            <button onclick="runPresetTest('di')">æµ‹è¯•ï¼šæ•°å­—è¾“å…¥(DI)</button>
            <button onclick="runPresetTest('do')">æµ‹è¯•ï¼šæ•°å­—è¾“å‡º(DO)</button>
            <button onclick="runPresetTest('counter')">æµ‹è¯•ï¼šè®¡æ•°å™¨(CI)</button>
            <div id="presetResult" class="result"></div>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:5100/api';
        
        function showLoading(elementId) {
            const elem = document.getElementById(elementId);
            elem.innerHTML = '<span class="status-indicator status-loading"></span>æ­£åœ¨å¤„ç†ï¼Œè¯·ç¨å€™...';
        }
        
        function showResult(elementId, success, message, details = null) {
            const elem = document.getElementById(elementId);
            const statusClass = success ? 'status-success' : 'status-error';
            const messageClass = success ? 'success' : 'error';
            
            let html = `<span class="status-indicator ${statusClass}"></span>`;
            html += `<span class="${messageClass}">${message}</span>`;
            
            if (details) {
                html += `<div class="code-block">${JSON.stringify(details, null, 2)}</div>`;
            }
            
            elem.innerHTML = html;
        }
        
        async function testConnection() {
            showLoading('connectionResult');
            try {
                const response = await fetch(API_BASE_URL + '/generation/test', {
                    method: 'GET'
                });
                
                if (response.ok) {
                    showResult('connectionResult', true, 'APIè¿æ¥æˆåŠŸï¼æœåŠ¡æ­£åœ¨è¿è¡Œã€‚');
                } else {
                    showResult('connectionResult', true, `APIå“åº”çŠ¶æ€: ${response.status}ã€‚æœåŠ¡æ­£åœ¨è¿è¡Œã€‚`);
                }
            } catch (error) {
                showResult('connectionResult', false, 'æ— æ³•è¿æ¥åˆ°APIæœåŠ¡', error.message);
            }
        }
        
        async function generateSolution() {
            const prompt = document.getElementById('prompt').value.trim();
            const model = document.getElementById('model').value;
            
            if (!prompt) {
                showResult('generateResult', false, 'è¯·è¾“å…¥éœ€æ±‚æè¿°');
                return;
            }
            
            showLoading('generateResult');
            
            try {
                const response = await fetch(API_BASE_URL + '/generation/generate-solution', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        prompt: prompt,
                        model: model
                    })
                });
                
                if (response.ok) {
                    // ä¸‹è½½ç”Ÿæˆçš„ZIPæ–‡ä»¶
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `${model}-GeneratedSolution.zip`;
                    document.body.appendChild(a);
                    a.click();
                    a.remove();
                    window.URL.revokeObjectURL(url);
                    
                    showResult('generateResult', true, 
                        `âœ… è§£å†³æ–¹æ¡ˆç”ŸæˆæˆåŠŸï¼å·²ä¸‹è½½ ${model}-GeneratedSolution.zip`,
                        { 
                            model: model,
                            timestamp: new Date().toLocaleString(),
                            promptLength: prompt.length
                        }
                    );
                } else {
                    const error = await response.json();
                    showResult('generateResult', false, 'ç”Ÿæˆå¤±è´¥', error);
                }
            } catch (error) {
                showResult('generateResult', false, 'è¯·æ±‚å¤±è´¥', error.message);
            }
        }
        
        function runPresetTest(testType) {
            const presets = {
                'ai': {
                    prompt: 'åˆ›å»ºä¸€ä¸ªJYUSB-1601æ¨¡æ‹Ÿè¾“å…¥ç¨‹åºï¼Œä½¿ç”¨MISDæ ‡å‡†çš„AIåŠŸèƒ½ï¼Œé…ç½®é€šé“0-3ï¼Œå·®åˆ†è¾“å…¥æ¨¡å¼ï¼Œé‡‡æ ·ç‡10kHzï¼Œè¿ç»­é‡‡é›†æ¨¡å¼ï¼Œå®æ—¶æ˜¾ç¤ºæ•°æ®å¹¶è®¡ç®—RMSå€¼ã€‚',
                    model: 'ernie-4.5-turbo-128k'
                },
                'ao': {
                    prompt: 'åˆ›å»ºä¸€ä¸ªJYUSB-1601æ¨¡æ‹Ÿè¾“å‡ºç¨‹åºï¼Œä½¿ç”¨MISDæ ‡å‡†çš„AOåŠŸèƒ½ï¼Œåœ¨é€šé“0è¾“å‡ºæ­£å¼¦æ³¢ï¼Œé¢‘ç‡100Hzï¼Œå¹…åº¦5Vï¼ŒæŒç»­10ç§’ã€‚',
                    model: 'ernie-4.5-turbo-128k'
                },
                'di': {
                    prompt: 'åˆ›å»ºä¸€ä¸ªJYUSB-1601æ•°å­—è¾“å…¥ç¨‹åºï¼Œä½¿ç”¨MISDæ ‡å‡†çš„DIåŠŸèƒ½ï¼Œç›‘æ§ç«¯å£0çš„8ä¸ªæ•°å­—è¾“å…¥é€šé“ï¼Œæ£€æµ‹çŠ¶æ€å˜åŒ–å¹¶è®°å½•æ—¶é—´æˆ³ã€‚',
                    model: 'ernie-speed-128k'
                },
                'do': {
                    prompt: 'åˆ›å»ºä¸€ä¸ªJYUSB-1601æ•°å­—è¾“å‡ºç¨‹åºï¼Œä½¿ç”¨MISDæ ‡å‡†çš„DOåŠŸèƒ½ï¼Œæ§åˆ¶ç«¯å£0çš„8ä¸ªLEDï¼Œå®ç°æµæ°´ç¯æ•ˆæœã€‚',
                    model: 'ernie-speed-128k'
                },
                'counter': {
                    prompt: 'åˆ›å»ºä¸€ä¸ªJYUSB-1601è®¡æ•°å™¨ç¨‹åºï¼Œä½¿ç”¨MISDæ ‡å‡†çš„CIåŠŸèƒ½ï¼Œé…ç½®è®¡æ•°å™¨0è¿›è¡Œé¢‘ç‡æµ‹é‡ï¼Œæ˜¾ç¤ºå®æ—¶é¢‘ç‡å€¼ã€‚',
                    model: 'ernie-lite-8k'
                }
            };
            
            const preset = presets[testType];
            if (preset) {
                document.getElementById('prompt').value = preset.prompt;
                document.getElementById('model').value = preset.model;
                showResult('presetResult', true, 
                    `å·²åŠ è½½ ${testType.toUpperCase()} æµ‹è¯•ç”¨ä¾‹`,
                    { testType: testType, model: preset.model }
                );
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶æµ‹è¯•è¿æ¥
        window.onload = function() {
            testConnection();
        };
    </script>
</body>
</html>