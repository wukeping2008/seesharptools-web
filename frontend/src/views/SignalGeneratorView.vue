<template>
  <div class="signal-generator-view">
    <div class="page-header">
      <h1 class="page-title">ä»»æ„æ³¢å½¢ä¿¡å·å‘ç”Ÿå™¨</h1>
      <p class="page-subtitle">ä¸“ä¸šçº§ä¿¡å·å‘ç”Ÿå™¨æ§ä»¶ï¼Œæ”¯æŒå¤šç§æ³¢å½¢ã€è°ƒåˆ¶å’Œæ‰«é¢‘åŠŸèƒ½</p>
    </div>

    <!-- ä¿¡å·å‘ç”Ÿå™¨æ¼”ç¤º -->
    <section class="demo-section">
      <div class="section-header">
        <h2 class="section-title">ä¿¡å·å‘ç”Ÿå™¨æ§ä»¶æ¼”ç¤º</h2>
        <p class="section-description">
          å®Œæ•´çš„ä¿¡å·å‘ç”Ÿå™¨åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ³¢å½¢ç”Ÿæˆã€å‚æ•°æ§åˆ¶ã€è°ƒåˆ¶å’Œæ‰«é¢‘
        </p>
      </div>

      <div class="demo-container">
        <SignalGenerator
          @output-change="handleOutputChange"
          @waveform-change="handleWaveformChange"
          @frequency-change="handleFrequencyChange"
        />
      </div>
    </section>

    <!-- åŠŸèƒ½ç‰¹æ€§è¯´æ˜ -->
    <section class="features-section">
      <div class="section-header">
        <h2 class="section-title">åŠŸèƒ½ç‰¹æ€§</h2>
      </div>

      <div class="features-grid">
        <div class="feature-item">
          <div class="feature-icon">ğŸŒŠ</div>
          <h4>å¤šç§æ³¢å½¢ç±»å‹</h4>
          <p>æ”¯æŒæ­£å¼¦æ³¢ã€æ–¹æ³¢ã€ä¸‰è§’æ³¢ã€é”¯é½¿æ³¢ã€è„‰å†²å’Œç™½å™ªå£°ç­‰6ç§æ ‡å‡†æ³¢å½¢</p>
        </div>

        <div class="feature-item">
          <div class="feature-icon">âš™ï¸</div>
          <h4>ç²¾ç¡®å‚æ•°æ§åˆ¶</h4>
          <p>é¢‘ç‡èŒƒå›´1mHz-100MHzï¼Œå¹…åº¦1mVpp-10Vppï¼Œç›´æµåç½®Â±5Vï¼Œç›¸ä½0Â°-360Â°</p>
        </div>

        <div class="feature-item">
          <div class="feature-icon">ğŸ“¡</div>
          <h4>è°ƒåˆ¶åŠŸèƒ½</h4>
          <p>æ”¯æŒAMã€FMã€PMä¸‰ç§è°ƒåˆ¶æ–¹å¼ï¼Œè°ƒåˆ¶é¢‘ç‡0.1Hz-1kHzï¼Œè°ƒåˆ¶æ·±åº¦0-100%</p>
        </div>

        <div class="feature-item">
          <div class="feature-icon">ğŸ“ˆ</div>
          <h4>æ‰«é¢‘åŠŸèƒ½</h4>
          <p>çº¿æ€§å’Œå¯¹æ•°æ‰«é¢‘ï¼Œæ‰«é¢‘èŒƒå›´å¯é…ç½®ï¼Œæ‰«é¢‘æ—¶é—´0.1s-60s</p>
        </div>

        <div class="feature-item">
          <div class="feature-icon">ğŸ‘ï¸</div>
          <h4>å®æ—¶æ³¢å½¢é¢„è§ˆ</h4>
          <p>Canvasç»˜åˆ¶çš„å®æ—¶æ³¢å½¢é¢„è§ˆï¼Œæ”¯æŒç½‘æ ¼æ˜¾ç¤ºå’Œå‚æ•°æ ‡æ³¨</p>
        </div>

        <div class="feature-item">
          <div class="feature-icon">ğŸ’¾</div>
          <h4>é¢„è®¾å’Œå¯¼å‡º</h4>
          <p>å¿«é€Ÿé¢„è®¾åŠ è½½ï¼Œå‚æ•°ä¿å­˜ï¼Œæ³¢å½¢æ•°æ®CSVå¯¼å‡ºåŠŸèƒ½</p>
        </div>
      </div>
    </section>

    <!-- æŠ€æœ¯è§„æ ¼ -->
    <section class="specs-section">
      <div class="section-header">
        <h2 class="section-title">æŠ€æœ¯è§„æ ¼</h2>
      </div>

      <div class="specs-grid">
        <div class="spec-category">
          <h4>é¢‘ç‡ç‰¹æ€§</h4>
          <div class="spec-items">
            <div class="spec-item">
              <span class="spec-label">é¢‘ç‡èŒƒå›´:</span>
              <span class="spec-value">1mHz - 100MHz</span>
            </div>
            <div class="spec-item">
              <span class="spec-label">é¢‘ç‡ç²¾åº¦:</span>
              <span class="spec-value">Â±0.001%</span>
            </div>
            <div class="spec-item">
              <span class="spec-label">é¢‘ç‡åˆ†è¾¨ç‡:</span>
              <span class="spec-value">1mHz</span>
            </div>
          </div>
        </div>

        <div class="spec-category">
          <h4>å¹…åº¦ç‰¹æ€§</h4>
          <div class="spec-items">
            <div class="spec-item">
              <span class="spec-label">å¹…åº¦èŒƒå›´:</span>
              <span class="spec-value">1mVpp - 10Vpp</span>
            </div>
            <div class="spec-item">
              <span class="spec-label">å¹…åº¦ç²¾åº¦:</span>
              <span class="spec-value">Â±1%</span>
            </div>
            <div class="spec-item">
              <span class="spec-label">ç›´æµåç½®:</span>
              <span class="spec-value">Â±5V</span>
            </div>
          </div>
        </div>

        <div class="spec-category">
          <h4>æ³¢å½¢ç‰¹æ€§</h4>
          <div class="spec-items">
            <div class="spec-item">
              <span class="spec-label">æ³¢å½¢ç±»å‹:</span>
              <span class="spec-value">6ç§æ ‡å‡†æ³¢å½¢</span>
            </div>
            <div class="spec-item">
              <span class="spec-label">ç›¸ä½èŒƒå›´:</span>
              <span class="spec-value">0Â° - 360Â°</span>
            </div>
            <div class="spec-item">
              <span class="spec-label">å ç©ºæ¯”:</span>
              <span class="spec-value">1% - 99%</span>
            </div>
          </div>
        </div>

        <div class="spec-category">
          <h4>è°ƒåˆ¶ç‰¹æ€§</h4>
          <div class="spec-items">
            <div class="spec-item">
              <span class="spec-label">è°ƒåˆ¶ç±»å‹:</span>
              <span class="spec-value">AM/FM/PM</span>
            </div>
            <div class="spec-item">
              <span class="spec-label">è°ƒåˆ¶é¢‘ç‡:</span>
              <span class="spec-value">0.1Hz - 1kHz</span>
            </div>
            <div class="spec-item">
              <span class="spec-label">è°ƒåˆ¶æ·±åº¦:</span>
              <span class="spec-value">0% - 100%</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- åº”ç”¨åœºæ™¯ -->
    <section class="applications-section">
      <div class="section-header">
        <h2 class="section-title">åº”ç”¨åœºæ™¯</h2>
      </div>

      <div class="applications-grid">
        <div class="application-item">
          <div class="application-icon">ğŸ”¬</div>
          <h4>ç§‘ç ”å®éªŒ</h4>
          <p>ä¸ºç§‘ç ”å®éªŒæä¾›ç²¾ç¡®çš„æµ‹è¯•ä¿¡å·ï¼Œæ”¯æŒå„ç§æ³¢å½¢å’Œè°ƒåˆ¶æ–¹å¼</p>
        </div>

        <div class="application-item">
          <div class="application-icon">ğŸ­</div>
          <h4>å·¥ä¸šæµ‹è¯•</h4>
          <p>è®¾å¤‡æµ‹è¯•å’Œæ ¡å‡†ï¼Œä¿¡å·å®Œæ•´æ€§æµ‹è¯•ï¼Œé¢‘å“ç‰¹æ€§æµ‹é‡</p>
        </div>

        <div class="application-item">
          <div class="application-icon">ğŸ“š</div>
          <h4>æ•™å­¦åŸ¹è®­</h4>
          <p>ç”µå­å·¥ç¨‹æ•™å­¦ï¼Œä¿¡å·å¤„ç†è¯¾ç¨‹ï¼Œå®éªŒå®¤æ•™å­¦æ¼”ç¤º</p>
        </div>

        <div class="application-item">
          <div class="application-icon">ğŸ”§</div>
          <h4>äº§å“å¼€å‘</h4>
          <p>ç”µè·¯è®¾è®¡éªŒè¯ï¼Œäº§å“æ€§èƒ½æµ‹è¯•ï¼Œæ•…éšœè¯Šæ–­å’Œè°ƒè¯•</p>
        </div>

        <div class="application-item">
          <div class="application-icon">ğŸ“¡</div>
          <h4>é€šä¿¡æµ‹è¯•</h4>
          <p>é€šä¿¡ç³»ç»Ÿæµ‹è¯•ï¼Œè°ƒåˆ¶è§£è°ƒéªŒè¯ï¼Œä¿¡é“ç‰¹æ€§åˆ†æ</p>
        </div>

        <div class="application-item">
          <div class="application-icon">ğŸµ</div>
          <h4>éŸ³é¢‘æµ‹è¯•</h4>
          <p>éŸ³é¢‘è®¾å¤‡æµ‹è¯•ï¼Œå£°å­¦æµ‹é‡ï¼ŒéŸ³è´¨è¯„ä¼°å’Œä¼˜åŒ–</p>
        </div>
      </div>
    </section>

    <!-- çŠ¶æ€ç›‘æ§ -->
    <section class="monitoring-section" v-if="currentConfig">
      <div class="section-header">
        <h2 class="section-title">å®æ—¶çŠ¶æ€ç›‘æ§</h2>
      </div>

      <div class="monitoring-grid">
        <div class="monitor-card">
          <h4>è¾“å‡ºçŠ¶æ€</h4>
          <div class="monitor-value" :class="outputEnabled ? 'active' : 'inactive'">
            {{ outputEnabled ? 'è¾“å‡ºå¼€å¯' : 'è¾“å‡ºå…³é—­' }}
          </div>
        </div>

        <div class="monitor-card">
          <h4>å½“å‰æ³¢å½¢</h4>
          <div class="monitor-value">{{ getWaveformName(currentConfig.type) }}</div>
        </div>

        <div class="monitor-card">
          <h4>é¢‘ç‡</h4>
          <div class="monitor-value">{{ formatFrequency(currentConfig.frequency) }}</div>
        </div>

        <div class="monitor-card">
          <h4>å¹…åº¦</h4>
          <div class="monitor-value">{{ currentConfig.amplitude.toFixed(3) }} Vpp</div>
        </div>

        <div class="monitor-card">
          <h4>ç›´æµåç½®</h4>
          <div class="monitor-value">{{ currentConfig.offset.toFixed(3) }} V</div>
        </div>

        <div class="monitor-card">
          <h4>ç›¸ä½</h4>
          <div class="monitor-value">{{ currentConfig.phase.toFixed(1) }}Â°</div>
        </div>
      </div>
    </section>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import SignalGenerator from '@/components/instruments/SignalGenerator.vue'

// å“åº”å¼æ•°æ®
const outputEnabled = ref(false)
const currentConfig = ref<any>(null)
const currentFrequency = ref(1000)

// æ³¢å½¢ç±»å‹æ˜ å°„
const waveformNames: Record<string, string> = {
  sine: 'æ­£å¼¦æ³¢',
  square: 'æ–¹æ³¢',
  triangle: 'ä¸‰è§’æ³¢',
  sawtooth: 'é”¯é½¿æ³¢',
  pulse: 'è„‰å†²',
  noise: 'å™ªå£°'
}

// äº‹ä»¶å¤„ç†
const handleOutputChange = (enabled: boolean) => {
  outputEnabled.value = enabled
  console.log('è¾“å‡ºçŠ¶æ€å˜åŒ–:', enabled)
}

const handleWaveformChange = (config: any) => {
  currentConfig.value = config
  console.log('æ³¢å½¢é…ç½®å˜åŒ–:', config)
}

const handleFrequencyChange = (frequency: number) => {
  currentFrequency.value = frequency
  console.log('é¢‘ç‡å˜åŒ–:', frequency)
}

// å·¥å…·å‡½æ•°
const getWaveformName = (type: string): string => {
  return waveformNames[type] || type
}

const formatFrequency = (freq: number): string => {
  if (freq >= 1000000) {
    return `${(freq / 1000000).toFixed(3)} MHz`
  } else if (freq >= 1000) {
    return `${(freq / 1000).toFixed(3)} kHz`
  } else {
    return `${freq.toFixed(3)} Hz`
  }
}
</script>

<style lang="scss" scoped>
.signal-generator-view {
  padding: 24px;
  max-width: 1400px;
  margin: 0 auto;
}

.page-header {
  text-align: center;
  margin-bottom: 48px;
  
  .page-title {
    font-size: 36px;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 12px;
  }
  
  .page-subtitle {
    font-size: 18px;
    color: var(--text-secondary);
    line-height: 1.6;
  }
}

.demo-section,
.features-section,
.specs-section,
.applications-section,
.monitoring-section {
  margin-bottom: 48px;
  
  .section-header {
    margin-bottom: 24px;
    
    .section-title {
      font-size: 24px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 8px;
    }
    
    .section-description {
      font-size: 16px;
      color: var(--text-secondary);
      line-height: 1.6;
    }
  }
}

.demo-container {
  background: var(--surface-color);
  border: 1px solid var(--border-color);
  border-radius: 12px;
  padding: 16px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

.features-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 24px;
  
  .feature-item {
    background: var(--surface-color);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 24px;
    text-align: center;
    transition: all 0.3s ease;
    
    &:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    }
    
    .feature-icon {
      font-size: 32px;
      margin-bottom: 16px;
    }
    
    h4 {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 8px;
    }
    
    p {
      font-size: 14px;
      color: var(--text-secondary);
      line-height: 1.5;
      margin: 0;
    }
  }
}

.specs-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 24px;
  
  .spec-category {
    background: var(--surface-color);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 20px;
    
    h4 {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 16px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--border-color);
    }
    
    .spec-items {
      .spec-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px solid #f0f0f0;
        
        &:last-child {
          border-bottom: none;
        }
        
        .spec-label {
          font-size: 14px;
          color: var(--text-secondary);
        }
        
        .spec-value {
          font-size: 14px;
          font-weight: 600;
          color: var(--text-primary);
          font-family: 'Consolas', 'Monaco', monospace;
        }
      }
    }
  }
}

.applications-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  
  .application-item {
    background: var(--surface-color);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 20px;
    text-align: center;
    transition: all 0.3s ease;
    
    &:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .application-icon {
      font-size: 28px;
      margin-bottom: 12px;
    }
    
    h4 {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 8px;
    }
    
    p {
      font-size: 12px;
      color: var(--text-secondary);
      line-height: 1.4;
      margin: 0;
    }
  }
}

.monitoring-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  
  .monitor-card {
    background: var(--surface-color);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 16px;
    text-align: center;
    
    h4 {
      font-size: 12px;
      font-weight: 500;
      color: var(--text-secondary);
      margin-bottom: 8px;
      text-transform: uppercase;
    }
    
    .monitor-value {
      font-size: 16px;
      font-weight: 600;
      font-family: 'Consolas', 'Monaco', monospace;
      
      &.active {
        color: #67c23a;
      }
      
      &.inactive {
        color: #909399;
      }
    }
  }
}

@media (max-width: 768px) {
  .signal-generator-view {
    padding: 16px;
  }
  
  .page-header {
    margin-bottom: 32px;
    
    .page-title {
      font-size: 28px;
    }
    
    .page-subtitle {
      font-size: 16px;
    }
  }
  
  .features-grid {
    grid-template-columns: 1fr;
    gap: 16px;
  }
  
  .specs-grid {
    grid-template-columns: 1fr;
    gap: 16px;
  }
  
  .applications-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
  }
  
  .monitoring-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
  }
}
</style>
